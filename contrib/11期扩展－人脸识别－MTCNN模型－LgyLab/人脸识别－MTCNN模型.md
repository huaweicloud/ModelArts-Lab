
### 人脸识别－MTCNN模型

  - MTCNN模型的主要研究成果有
    1. 提出一种新的级联型CNNS框架、用于人脸检测和对齐、并设计了轻量级CNN架构以实现实时性。
    2. 提出一种有效的方法进行在线困难样本挖掘。
    3. 与最先进的人脸检测和人脸对齐算法相比、性能显著增加。
  - 人脸识别未来研究发展方向
    - 基本思想： 利用CNN作为基本单元构成
    - 多层网络：区分目标的标定人脸特征点
    - 核心问题： 有脸特征点的标定
    - 公式 $Loss_{MTCNN}= a_{dec}Loss_{dec} + a_{roi}Loss_{roi} + a_{landmark}Loss_{landmark}$
      - $Loss_{MTCNN}$ ： 网络对应损失函数
      - $Loss_{dec}$: 矩形框内分类
      - $Loss_{landmark}$: 特征点位置回归
  - 人脸识别的难题及在MTCCN中的优化解决 
    1. 难题
        - 在无约束环境中、由于各种姿势变化、光线不均和遮挡的情况下对于检测是一个很大挑战
    2. 优化解决 
     - 三个精心设计的尝试卷积网络、以粗略到精细的方式预测面部和特征点的位置
        - 困难样本挖掘: mining 挖掘是分为二个大类
          - 一种是SVM 支持向量机中用到的margin-based,在训练时将违反当前模型边缘的样本认为是hard example
          - 另一种是在级联框架中false positive不属于这个类别的样本认为是hard example
    3. 基础概念
        - 边框回归
        ![](2019-10-29-23-37-31.png)
        - 随机森林： 是集成学习的产物、集成学习是为了解决单个模型或者某一组参数的模型所固有的缺陷、从而整合起更多的模型、取长补短、避免局限性、随机森林将许多棵决策树整合成森林、并合成用来预测最终结果
        - CNNS 包括三个部分
          - P-Net 它通过浅层CNN网络快速生成候选窗口
          - R-Net 它通过更复杂的CNN细化第一部分产生的候选窗口以拒绝大量不包人脸的窗口
          - O-Net 它使用更强大的CNN网络来细化结果并输出人脸特征点的位置
  - 实现方法
      - 阶段1：充分利用卷积网络搭建P-Net，以与类似的方式获得候选窗口与及边界框回归向量。然后我们使用估计的边界框回归向量来核准候选者。之后我们采用非最大抑制(NMS)来合并高度重叠的候选者
        ![](2019-10-30-00-06-39.png)
  - 阶段2：所有候选窗口都被送到另一个CNN，称为R-Net，它将进一步剔除大量错误候选框、使用边界框回归执行校准，以及NMS将候选窗口合并。
        ![](2019-10-30-00-11-38.png)
  - 阶段3：这个阶段类似于第二阶段、但在这个阶段我们的目标是检测更详细的人脸面部、特点是、网络将输出五个面部特征点的位置
  - 训练：利用三项任务训练CNN检测器：面部/非面部，边界框回归和人脸面部特征点定位
    1. 面部分类：训练目标被制定为两类分类问题、对于人脸分类问题、我们使用交叉熵损失函数
    交叉熵损失函数
    $$$L_{i}^{det} = -(y_{i}^{det}log(p_{i})+ (1-y_{i}^{det})(1-log(p_{i})))$$$
    $ p_{i} $ 表示网络判定是一个人脸的概率
    $ L_{i}^{det} \in {0,1} $ 是样本的标签
    2. 边界框回归：对于每个候选窗口、我们预测它与最近的地面实况之间的偏移（边界框的左上、高度和宽度）
    Euclidean 损失函数
    $$$ L_{i}^{box} = \left \| \bar{y}_{i}^{box}- y_{i}^{box}  \right \|_{2}^{2} $$$
    $ \bar{y}_{i}^{box} $ :是网络中得到的回归目标
    $ y_{i}^{box} $ ： 是真实坐标、包含左上角的横纵坐标、高度、宽度。
   
    3. 人脸特点点定位：类似于边界框回归任务、人脸特征点检测被可视化为回归问题、我们最小化Euclidean损失函数
    $$$ L_{i}^{landmark} = \left \| \bar{y}_{i}^{landmark}- y_{i}^{landmark}  \right \|_{2}^{2} $$$
    L2范数损失函数：也称为最小平方误差(LSE)、总的来说、它是把目标值与估计值的差值的平方最小化。
    
    4. 多源训练：由于我们在每个CNN中分配了不同的任务、因此在学习过程中存在不同类型的训练图像、例如面部，非面部和部分对齐的面部、在这种情况下，一些损失函数就不能使用
    ![](2019-10-30-00-24-55.png)
    5. 在线困难样本挖掘：与原始分类器训练后进行传统困难样本挖掘不同，在人脸分类任务中进行在线困难样本挖掘、以适应训练过程。特别是在每个小批量中，我们对来自所有样本的前向传播除阶段计算的损失进行排序、并选择其中前70%作为硬样本、我们只计算后向传播阶段中的困难样本的梯度。
  - 限制及优化解决
    - 限制
      - 一些滤波器缺乏权重的多样性、这可能限制它们产生有区别的检测 
      - 与其他多类异像检测和分类任务相比、人脸检测是一项挑战性的二元分类任务、因此需要轻少的过滤器、但需要对它们进行更多的区分。
    - 优化
      - 减少滤波器的数量并将5*5的修改为3*3 以减少计算、同时增加网络深度以获得更好的性能、通过这些改进可以获得更好性能
    - 对比
    ![](2019-11-03-20-31-14.png)
### 总结
  - 本文只是一个初级的学习心得、希望各位大神多多指教。
